<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>Call the Cactus</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    html, body {
      height: 100%;
      overflow: hidden;
    }
    #map {
      height: 100%;
      width: 100%;
    }
    #main-call-button {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 10;
    }
    .cta-button {
      background-color: orange;
      color: white;
      border: none;
      padding: 15px 30px;
      font-size: 1.2rem;
      cursor: pointer;
      border-radius: 5px;
      text-transform: uppercase;
      transition: background-color 0.3s ease;
    }
    .cta-button:active {
      background-color: darkorange;
    }
    #menu-button {
      position: absolute;
      bottom: 20px;
      right: 20px;
      background-color: white;
      border: 1px solid #ccc;
      padding: 10px;
      border-radius: 5px;
      z-index: 10;
      cursor: pointer;
    }
    #menu-options {
      position: absolute;
      bottom: 70px;
      right: 20px;
      background-color: white;
      border: 1px solid #ccc;
      padding: 10px;
      border-radius: 5px;
      z-index: 10;
      display: none;
    }
    #menu-options button {
      display: block;
      background: none;
      border: none;
      padding: 8px 0;
      text-align: left;
      width: 100%;
      cursor: pointer;
    }
    .info-window {
      font-family: sans-serif;
    }
    .status-bar {
      display: flex;
      gap: 4px;
      margin-bottom: 5px;
    }
    .bar {
      width: 20px;
      height: 5px;
      border-radius: 2px;
      background-color: lightgray;
    }
    .active-red { background-color: red; }
    .active-yellow { background-color: gold; }
    .active-green { background-color: mediumseagreen; }
  </style>
</head>
<body>
  <div id="map"></div>

  <div id="main-call-button">
    <button class="cta-button" id="call-the-cowboy">Call the Cowboy</button>
  </div>

  <div id="menu-button">
    &#9776;
  </div>

  <div id="menu-options">
    <button id="toggle-view">List View</button>
    <button onclick="window.location.href='tel:+14356024304'">Call</button>
    <button onclick="window.location.href='sms:+14356024304'">Text</button>
    <button onclick="window.location.href='about.html'">About</button>
  </div>

  <script>
    const statusColors = {
      1: 'red',
      2: 'gold',
      3: 'green'
    };

    const locations = [
      { lat: 40.63187478288313, lng: -111.488077538129840, title: "Hopkins", status: 3 },
      { lat: 40.79079537119528, lng: -111.8870219260070734, title: "Cosby", status: 1 },
      { lat: 40.66657863620859, lng: -111.4940910476343136, title: "Tanner", status: 3 },
      { lat: 40.65040926474864, lng: -111.3141574976087539, title: "Hennessy", status: 2 },
      { lat: 40.70017011307595, lng: -111.5490344880542347, title: "Barrick", status: 1 },
      { lat: 40.7672909767582, lng: -111.5279312398168232, title: "Goldsmith", status: 2 }
    ];

    let map;
    let infoWindows = [];
    let markers = [];

    function initMap() {
      map = new google.maps.Map(document.getElementById("map"), {
        zoom: 10,
        center: { lat: 40.7, lng: -111.8 },
        disableDefaultUI: true
      });

      const bounds = new google.maps.LatLngBounds();

      locations.forEach(loc => {
        const iconColor = statusColors[loc.status];
        const marker = new google.maps.Marker({
          position: { lat: loc.lat, lng: loc.lng },
          map,
          title: loc.title,
          icon: {
            path: 'M8 0c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2s2-.9 2-2V2c0-1.1-.9-2-2-2z',
            fillColor: iconColor,
            fillOpacity: 1,
            strokeWeight: 0,
            scale: 2,
            anchor: new google.maps.Point(8, 16)
          }
        });

        const statusHTML = '<div class="status-bar">' +
          Array.from({ length: 3 }, (_, i) => {
            let className = 'bar';
            if (loc.status === 1 && i === 0) className += ' active-red';
            if (loc.status === 2 && i < 2) className += ' active-yellow';
            if (loc.status === 3) className += ' active-green';
            return `<div class="${className}"></div>`;
          }).join('') + '</div>';

        const infoWindow = new google.maps.InfoWindow({
          content: `<div class="info-window">
                      ${statusHTML}
                      <strong>${loc.title}</strong>
                      <div class="menu-buttons">
                        <a href="#">Project Info</a> |
                        <a href="#">Cameras</a> |
                        <a href="tel:+14356024304">Call</a> |
                        <a href="sms:+14356024304">Text</a>
                      </div>
                    </div>`
        });

        marker.addListener("click", () => {
          infoWindows.forEach(iw => iw.close());
          infoWindow.open(map, marker);
        });

        markers.push(marker);
        infoWindows.push(infoWindow);
        bounds.extend(marker.getPosition());
      });

      map.fitBounds(bounds);

      const callButton = document.getElementById('main-call-button');

      map.addListener("dragstart", () => {
        callButton.style.display = "none";
      });
      map.addListener("zoom_changed", () => {
        callButton.style.display = "none";
      });

      const menuToggle = document.getElementById('menu-button');
      const menuOptions = document.getElementById('menu-options');

      menuToggle.addEventListener("click", () => {
        menuOptions.style.display = menuOptions.style.display === "block" ? "none" : "block";
      });

      const toggleViewButton = document.getElementById('toggle-view');
      let inListView = false;
      toggleViewButton.addEventListener("click", () => {
        inListView = !inListView;
        toggleViewButton.textContent = inListView ? "Map View" : "List View";
        alert("This would toggle to " + (inListView ? "list" : "map") + " view.");
      });
    }
  </script>

  <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCy0CmR2bZF9YBNfSGX5hZ-wK1MD1AwOu0&callback=initMap">
  </script>
</body>
</html>
